/*********************************************************************/
作者　塩ハム(d)

未完成なのでエラーが出ても損害が出ても塩ハム(d)は責任を負いません
/*********************************************************************/

・必須環境：
  python(python3.6で動作確認済み)
  web3.py

・使い方：
0.環境を構築する(既にできている人は1にスキップ)
  - pythonをインストールする
    非公式インストーラリンク
    https://pythonlinks.python.jp/ja/index.html
  - 環境変数にパスを通す(インストーラで設定も可)
  - web3.pyをインストールする
    コマンドプロンプトを起動
    以下のコマンドを入力
    pip install web3

1.settings.jsonで設定をする

exsample
{
    "wallet_address":"0x0000000000000000000000000000000000000000",
    "wallet_privatekey":"b000000000000000000000000000000000000000000000000000000000000000",
    "rpc":"https://rpc.ftm.tools",
    "ftm_balance_limit":5,
    "ticket_quantity":0.5,
    "mint_quantity":4,
    "slippage":50,
    "transaction_speed":15,
    "gas_limit_gwei":500
}

"ftm_balance_limit":5		// 5 FTM以下になるとプログラム終了します
"ticket_quantity":0.5		// 0.5 Ticketをmintに使います
"mint_quantity":4			// 4 Medal以上mintできる時にmintを試みます
"slippage":50				// 50%までスリッページを許容します(今回の場合 2 Medal)
"transaction_speed":15		// トランザクションが取り込まれる時間の目標です(今回の場合 15秒)
							// 高くするほどガス代がかかります(未実装)
"gas_limit_gwei":500		// 本プログラムで使用するガス代の最大値です(今回の場合 500 gwei)


2.auction_bot.pyを起動する(ダブルクリックでおｋ)

3.暇なときは踊っていてください

・トラブルシューティング：
Q.jsonのloadが失敗します
A.auction_bot.pyとsettings.jsonを同じフォルダに入れてください
Q.○○ is lowとか出ます
A.残高がsettings.jsonで設定した数値以下になっています
  あきらめるか調整してください
Q.コマンドプロンプトでやりたいです
A.以下のコマンドを入れましょう
  cd bot配置までのパス\defi_olympiads
  python auction_bot.py
Q.nonce too lowとエラーが出ます
A.原因はトランザクションの失敗もしくは、fantomで別の取引をしたことです
  時間をおけば直りますが、早く直したい場合はmodify_nonce.pyで最新トランザクションのnonceを設定してください
Q.なんかエラーが出ます
A.プログラムを再起動してみてください、私も困っています()


・変更履歴
version 0.1.4
  - たぶんFTM尽きるまで掘れるくらい安定しました
    スリッページロス以外ではほぼエラー落ちしません
  - ABIロードを修正しましたが誤差です
  - RPCを設定可能にしました
  - mintしたmedalの数を表示しました、大変でした
  - トランザクションタイムアウトエラーを検出できるようにしました
  - gas取得で落ちなくなりました

version 0.1.3
  - もうだいぶ安定したってことでいいですか
  - 残高確認を失敗しても継続します
  - トランザクションのタイムアウトを検出できるようにしました

version 0.1.2
  - 安定度を上げました
  - gasとnonceの取得順番を改善しました
  - スリッページロスを検出できるようにしました
  - nonceエラーを検出できるようにしました
  - gasが高い時の待機をわかりやすくしました
  
version 0.1.1
  - 安定度をぐんと上げました
  - sqliteにトランザクションの情報を記録しました
  - modify_nonce.pyを追加しました
  - ABIをフォルダにまとめました
  - 待機時間を減らしました
  - 誤字を直しました(Ticket mint => Medal mint)

version 0.1.0
  - 安定度を上げました
  - 終了時にキー入力を待機するようにしました
  - 経過を見やすくしました

versionなし
  - 一応動きました